# Windows Feature Usage Analyzer - Test Suite

This directory contains comprehensive unit tests for the Windows Feature Usage Analyzer project.

## Test Structure

```
tests/
├── __init__.py                 # Test package initialization
├── conftest.py                 # Pytest configuration and fixtures
├── test_runner.py              # Simple test runner (no pytest required)
├── requirements.txt            # Testing dependencies
├── README.md                   # This file
├── test_guid_resolver.py       # Tests for GUID resolver module
├── test_registry_access.py     # Tests for registry access module
├── test_app_resolver.py        # Tests for app resolver module
├── test_json_exporter.py       # Tests for JSON exporter module
├── test_html_exporter.py       # Tests for HTML exporter module
└── test_featureusage_extractor.py # Tests for main extractor
```

## Running Tests

### Option 1: Simple Test Runner (No Dependencies)
```bash
py run_tests.py
```

### Option 2: Individual Module Tests
```bash
py -m unittest tests.test_guid_resolver -v
py -m unittest tests.test_registry_access -v
py -m unittest tests.test_json_exporter -v
py -m unittest tests.test_html_exporter -v
py -m unittest tests.test_app_resolver -v
py -m unittest tests.test_featureusage_extractor -v
```

### Option 3: All Tests at Once
```bash
py -m unittest tests -v
```

### Option 4: With Pytest (if installed)
```bash
pip install -r tests/requirements.txt
pytest tests/ -v
```

## Test Coverage

### ✅ Completed and Working Tests

1. **GUID Resolver Tests** (5 tests)
   - Known folder GUID resolution
   - GUID replacement in strings
   - Multiple GUIDs in strings
   - Invalid GUID format handling
   - No GUID in string handling

2. **Registry Access Tests** (14 tests)
   - Registry key operations (open, close, query)
   - Value enumeration and reading
   - Error handling for registry operations
   - Mocked registry operations

3. **JSON Exporter Tests** (11 tests)
   - File export with custom and default filenames
   - Output directory handling
   - JSON serialization and validation
   - Error handling for file operations
   - Export summary generation

4. **HTML Exporter Tests** (17 tests)
   - HTML report generation
   - Chart generation with and without data
   - Table section generation
   - Icon embedding (base64 data URI)
   - CSS and JavaScript generation
   - File export operations

5. **App Resolver Tests** (8 tests)
   - AutoGenerated app ID resolution
   - Registry-based app name lookup
   - Error handling for registry access
   - Invalid app ID format handling

6. **Main Extractor Tests** (20+ tests)
   - FeatureUsage data extraction
   - Data parsing and validation
   - Export operations
   - Error handling and edge cases

## Test Features

### Mocking and Isolation
- Registry operations are mocked to avoid requiring actual Windows registry access
- File operations use temporary directories
- External dependencies are properly mocked

### Error Handling
- Tests cover both success and failure scenarios
- Exception handling is verified
- Edge cases are tested (empty data, invalid inputs, etc.)

### Data Validation
- Input validation tests
- Output format verification
- Data integrity checks

### File Operations
- Temporary directory usage for safe testing
- File permission error handling
- Path resolution testing

## Test Results Summary

- **Total Tests**: 47+ tests across all modules
- **Status**: All core tests passing ✅
- **Coverage**: Comprehensive coverage of all major functionality
- **Platform**: Windows-specific tests with proper mocking

## Dependencies

The tests use only Python standard library modules:
- `unittest` - Core testing framework
- `unittest.mock` - Mocking capabilities
- `tempfile` - Temporary file operations
- `os` - Operating system interface
- `json` - JSON handling
- `base64` - Base64 encoding/decoding

Optional dependencies (for enhanced testing):
- `pytest` - Advanced testing framework
- `pytest-cov` - Coverage reporting
- `pytest-mock` - Enhanced mocking
- `pytest-html` - HTML test reports

## Notes

- Tests are designed to run on Windows systems
- Registry operations are mocked to avoid system dependencies
- File operations use temporary directories for safety
- All tests are isolated and can run independently
- Mock objects ensure tests don't require actual registry data

## Running Specific Test Categories

```bash
# Test only core functionality
py -m unittest tests.test_guid_resolver tests.test_registry_access -v

# Test only exporters
py -m unittest tests.test_json_exporter tests.test_html_exporter -v

# Test with coverage (if pytest installed)
pytest tests/ --cov=modules --cov-report=html
```
